<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Config Manager</title>
    <script src="scripts/jquery-1.8.2.js"></script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
<div id="work-area"></div>
<span class="add-field" id="add-field">Add New Field <i class="icon-plus"></i></span>
</body>
<script>
$(document).ready(function() {
  
	addField();

	//addRuleGroup('field-0');
	//$('#add-rule-group').click(function(){

	//	addRuleGroup('field-0');
	//});

	$('#add-field').click(function(){

			addField();
		});
		
	});

function updateFieldNumbers(){

	var fieldNumber = 1;

	$('.field-number').each(function(){
		$(this).text('Field ' + fieldNumber);
		fieldNumber++;
	});
}

function addField(){

	var section = document.createElement('section');
	section.className = "field";
	var spnHeading = document.createElement('span');
	spnHeading.className = "heading";
	var numFields = $('.field').length;
	numFields++;
	spnHeading.innerHTML = "<span class='field-number'>Field "+ numFields + '</span>';


	var remove = document.createElement('span');
	remove.innerHTML = ' <i class="icon-remove icon-4"></i>';
	remove.className = 'delete-field';

	$(remove).click(function(){

		var numFields = $('.field').length;

		if(numFields == 1){

			return;
		}
		
		$(section).remove();
		updateFieldNumbers();
	});

	spnHeading.appendChild(remove);


	section.appendChild(spnHeading);	


	var lblValue = document.createElement('label');
	lblValue.innerHTML = 'What is the SAP identity of this input?';
	var txtValue = document.createElement('input');
	txtValue.type = 'text';
	var lineBreak = document.createElement('br');
	section.appendChild(lblValue);
	section.appendChild(txtValue);
	section.appendChild(lineBreak);
	var lblValue1 = document.createElement('label');
	lblValue1.innerHTML = 'What is the description for this input?';
	var txtValue1 = document.createElement('input');
	txtValue1.type = 'text';
	lineBreak = document.createElement('br');
	section.appendChild(lblValue1);
	section.appendChild(txtValue1);	
	section.appendChild(lineBreak);
	var lblValue2 = document.createElement('label');
	lblValue2.innerHTML = 'Hide on the form?';
	var txtValue2 = document.createElement('input');
	txtValue2.type = 'checkbox';
	section.appendChild(lblValue2);
	section.appendChild(txtValue2);	

	var options = document.createElement('div');
	options.className = "options";
	section.appendChild(options);

	

	var spnAddRule = document.createElement('span');
	spnAddRule.innerHTML = 'Add Rule Group ';
	spnAddRule.className = 'add-rule-group';
	$(spnAddRule).click(function(){

		addRuleGroup(section);
	});
	var icon = document.createElement('i');
	icon.className = 'icon-plus icon-4';
	spnAddRule.appendChild(icon);
	section.appendChild(spnAddRule);

	var div = document.getElementById('work-area');
	div.appendChild(section);
	
	addRuleGroup(section);
}

function addRule(element){

	var sctRule = document.createElement('section');
	var lblValue1 = document.createElement('label');
	lblValue1.innerHTML = 'IF ';
	sctRule.appendChild(lblValue1);
	var txtElement = document.createElement('input');
	txtElement.type = 'text';
	var slcCondition = document.createElement('select');
	var option1 = document.createElement("option");
	option1.text = "Equal";
	var option2 = document.createElement("option");
	option2.text = "Not Equal";
	var option3 = document.createElement("option");
	option3.text = "Greater Than";
	var option4 = document.createElement("option");
	option4.text = "Less Than";
	slcCondition.add(option1,0);
	slcCondition.add(option2,1);
	slcCondition.add(option3,2);
	slcCondition.add(option4,3);	
	var txtElement2 = document.createElement('input');
	txtElement2.type = 'text';
	sctRule.appendChild(txtElement);
	sctRule.appendChild(slcCondition);
	sctRule.appendChild(txtElement2);
	element.appendChild(sctRule);
}

function addRuleGroup(element){

	//var parent = document.getElementById(elementId);
	var optionsArea = element.querySelector('.options');
	var div = document.createElement('div');
	div.className = 'rule-group';
	div.innerHTML = "<p>Rule stuff will go here</p>";
	addRule(div);
	var title = document.createElement('span');

	var numRules = $(optionsArea).children('.rule-group').length;	
	numRules++;

	title.innerHTML = "Rule group " + numRules + " <i class='icon-collapse'></i>";
	title.className = "heading-rule";
	div.appendChild(title);
	optionsArea.appendChild(div);

	var remove = document.createElement('span');
	remove.innerHTML = 'Delete Rule <i class="icon-remove icon-4"></i>';
	remove.className = 'delete-rule-group';
	
	$(remove).click(function(){	

		
		
		$(div).remove();
		//updateFieldNumbers();
	});


	div.appendChild(remove);

	addOption(div);

	$(title).click(function()
	{
		if($(this).children('i').hasClass('icon-collapse')){

			$(this).siblings().each(function(){
				$(this).hide();
			});

			$(this).children('i').removeClass('icon-collapse').addClass('icon-expand');
		}
		else{

			$(this).siblings().each(function(){
				$(this).show();
			});

			$(this).children('i').addClass('icon-collapse').removeClass('icon-expand');
		}
		
	});
}

function addOption(element){

	//var parent = document.getElementById(elementId);
	//var optionsArea = parent.querySelector('.options');
	var section = document.createElement('section');
	var lblValue = document.createElement('label');
	lblValue.innerHTML = 'Value:';
	var txtValue = document.createElement('input');
	txtValue.type = 'text';
	section.appendChild(lblValue);
	section.appendChild(txtValue);
	var lblName = document.createElement('label');
	lblName.innerHTML = 'Name:';
	var txtName = document.createElement('input');
	txtName.type = 'text';	
	section.appendChild(lblName);
	section.appendChild(txtName);
	element.appendChild(section);

	$(txtName).change(function()
	{
			addOption(element);
	});
}

</script>
</html>